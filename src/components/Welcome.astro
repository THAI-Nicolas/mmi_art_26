---
import { GetArtistById, getImageUrl } from "../lib/backend"
import { pb } from "../lib/pb"
const id = "5kli99frxg9udlh"
const artiste = await GetArtistById(id)
const urlAvatar = artiste ? getImageUrl(artiste, artiste.avatar) : null

//import BlobTransition from "./BlobTransition.astro"
import BlobDynamic from "./ui/BlobDynamic.astro";
import BlobTransition from "./ui/BlobTransition.astro";
import '../../src/styles/global.css';
import BackgroundGrid from "./ui/BackgroundGrid.astro";
import Logo from "../assets/icones/logo.svg";
import AnimatedH1 from "./ui/AnimatedH1.astro";
---

<BackgroundGrid />


<div class="relative w-full z-10">
	<Logo class="w-20 h-20"/>
	<AnimatedH1 variant="accueil" text="MMI ART 26" />
	<AnimatedH1 variant="exposition" text="MMI ART 26" />
	<h2>Titre 2</h2>
	<h3>Titre 3</h3>
	
	


	<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Asperiores, labore. Lorem ipsum dolor sit, amet consectetur adipisicing elit. Eveniet veritatis sed, reprehenderit facere modi aliquam.</p>
	<div class="mt-16">
		<a class="btn" href="/artistes">Les artistes</a>
	</div>
	

	<nav class="mt-16">
		<ul>
			<li><a href="">Accueil</a></li>
			<li><a href="">Artistes</a></li>
			<li><a href="">Contact</a></li>
		</ul>
	</nav>

	<section class="mt-20">
		{artiste ? (
			<>
				<h3>Test des fonctionnalitées Backend</h3>
				<div class=" flex items-center">
					<img class="w-20" src={urlAvatar} alt="">
					<p>{artiste.name}</p>
				</div>
				<p>{artiste.bio}</p>
				<h3>Les oeuvres de {artiste.name}</h3>
				
				<ul>
					{
							artiste.expand?.oeuvres_id?.map((oeuvre) => {
					
					const imageRecord = oeuvre.expand.oeuvres_images[0]; 

					
					const urlOeuvre = getImageUrl(imageRecord, imageRecord.images);

					return (
					<div>
						<h3>{oeuvre.title}</h3>
						<BlobDynamic imageUrl={urlOeuvre} width={200} height={200} variant={4} />
					</div>
					);
				})
						}
				</ul>

				<h3>Les réseaux sociaux de {artiste.name}</h3>
				<ul>
					{
						artiste.expand?.canaux_id?.map((canal) => {
					return (<div>
						<p>Plateforme : {canal.platform}</p>
						<a href=`${canal.link}` target="_blank" >Lien : {canal.link}</a>
					</div>)
					})
				}
			</ul>
		</>
		) : (
			<div class="text-red-500 p-4">
				<p>❌ Erreur : Impossible de charger l'artiste.</p>
				<p class="text-sm mt-2">Vérifiez que PocketBase est lancé et que l'ID existe.</p>
			</div>
		)}

		<h3>Tests des blops</h3>
		
		<div class="relative inline-block">
			<BlobDynamic color="#000000" variant={1} />
			<BlobDynamic color="#000000" variant={2} />
			<BlobDynamic color="#000000" variant={3} />
			<BlobDynamic color="#000000" variant={4} />
			
		</div>

		<h2>test bloptransition</h2>
		<div class="fond-tache-container">
			<BlobTransition
				svgPath="M1176.07 0C1233.65 0.000212617 1268.84 50.1415 1263.19 81.0322C1254.17 130.279 1211.38 166.758 1244.16 214.445C1273.7 257.424 1352.8 287.419 1425.4 268.616C1556.27 234.721 1558.61 119.656 1689.75 130.727C1832.94 142.815 1792.89 248.022 1914.55 278.018C1920.06 279.382 1914.55 490.217 1914.55 494.253V771.115H1917V1976.3C1907.99 2015.7 1935.2 2209.85 1829.38 2202.39C1708.72 2193.88 1766.8 2320.58 1550.51 2320.58C1480.42 2320.58 1479.92 2526.97 1255.62 2526.97C1009.31 2526.97 1035.83 2339.38 927.184 2339.38C846.577 2339.38 826.049 2375.42 814.033 2386.84C766.47 2432.06 822.544 2485.78 826.049 2526.97C829.553 2568.16 793.806 2608 736.931 2608C679.354 2608 645.347 2557.86 651 2526.97C660.012 2477.72 701.616 2441.24 668.84 2393.55C639.3 2350.58 560.195 2320.58 487.599 2339.38C356.734 2373.28 354.393 2488.34 223.247 2477.27C80.0567 2465.19 120.11 2359.98 -1.55176 2329.98C-7.05899 2328.62 -1.55195 2117.78 -1.55176 2113.75V1836.88H-4V631.695C5.01198 592.298 -22.1963 398.151 83.6162 405.61C204.277 414.117 146.2 287.419 362.487 287.419C432.581 287.419 433.081 81.0322 657.38 81.0322C903.686 81.0322 877.172 268.616 985.816 268.616C1066.42 268.616 1086.95 232.583 1098.97 221.16C1146.53 175.943 1090.46 122.22 1086.95 81.0322C1083.45 39.8446 1119.19 0 1176.07 0Z"
				viewBox="0 0 1917 2608"
				color="#000000"
				deformStrength={0.3}
			/>
    	</div>

		<div>
			<BackgroundGrid/> test
		</div>

	</section>
</div>